<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Accessible Feedback Form</title>
        <meta charset="utf-8">
        <style>.control, fieldset {
      margin: 6px 0;
    }
    
    label {
      display: inline-block;
      width: 120px;
      vertical-align: top;
    }
    
    input + label {
      width: auto;
    }
    
    .error, .required {
      color: red;
    }
    
    fieldset ul {
      margin: 0;
    }</style>
    </head>
    <body>
        <h1>Feedback form</h1>
        <fieldset>
            <legend>Please fill out this form</legend>
    <!-- Arranged form elements inside a fieldset and added a legend to enhance accessibility, particularly for screen readers. -->
    <form role="form" aria-labelledby="form-title">
      <!-- Utilize the for attribute to link labels with corresponding input fields. -->

   <div class="control">
     <label for="name">Full name <span class="required">*</span></label>
     <input id="name" name="name" type="text" aria-required="true" aria-describedby="name-instructions"/>
     <!-- Provide inline instructions specifically designed for screen readers. -->
     <span id="name-instructions" class="sr-only">Please enter your full name. This field is required.</span>
   </div>
   <div class="control">
     <label for="biography">Biography</label>
     <textarea id="biography" name="biography" aria-describedby="biography-instructions"></textarea>
     <!-- Include inline instructions tailored for screen readers. -->
 <span id="biography-instructions" class="sr-only">Include examples of your skills in JavaScript. Mention if any.</span>
   </div>

   <!-- Incorporated a fieldset and legend to group the radio buttons. -->
  
     <legend>Gender <span class="required">*</span></legend>
     <div class="control">
         <label for="gender_male">Male</label>
       <input id="gender_male" name="gender" type="radio" value="male" aria-describedby="gender-instructions"/>
    
     </div>
     <div class="control">
         <label for="gender_female">Female</label>
       <input id="gender_female" name="gender" type="radio" value="female" aria-describedby="gender-instructions"/>
      
     </div>
     <!-- Provided inline instructions for screen readers regarding the gender field. -->
 <span id="gender-instructions" class="sr-only">Please select your gender. This field is required.</span>
    <!-- Standard error message for the gender group. -->
 <span id="gender-error" class="error"></span>
    
   </fieldset>
     
   <div class="control">
     <input id="accept_agbs" name="accept_agbs" type="checkbox" value="1" aria-required="true" aria-describedby="terms-instructions"/>
     <label for="accept_agbs"><span class="required">*</span> I accept the terms and conditions </label>
     <!--Inline instructions for screen readers-->
 <span id="terms-instructions" class="sr-only"> Accept the terms and conditions before submitting the form.</span>
   </div>
     
   <div class="control">
 <button id="registerButton" aria-describedby="button-instructions">Register</button>
 <!-- Include inline instructions for screen readers related to the button. -->
 <span id="button-instructions" class="sr-only">Accept the form by clicking the register button</span>
</div>
 </form>
      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
          <script>
            $(document).ready(function () {
                // Add event listeners to the input fields.
                $('#name').on('input', function () {
                    validateInput('name', 'Please enter your name!');
                });
        
                
        
                $('input[name="gender"]').on('change', function () {
                    validateInput('gender', 'Please select your gender!');
                });
        
                $('#accept_agbs').on('change', function () {
                    validateInput('accept_agbs', 'You must accept our terms and conditions!');
                });
        
                $('#registerButton').click(function (e) {
                    e.preventDefault(); // Stop the form from submitting
        
                    // Clear previous error summary
                    $('fieldset.errors').remove();
        
                    // Validating inputs
                    var isFormValid = true;
                    if (!validateInput('name', 'Please enter your name!')) isFormValid = false;
                   
                    if (!validateInput('gender', 'Please select your gender!')) isFormValid = false;
                    if (!validateInput('accept_agbs', 'You must accept our terms and conditions!')) isFormValid = false;
        
                    // If no errors are present, display success message
                    if (isFormValid) {
                        alert('All inputs are valid.');
                    }
                });
        
                // Manage focus when error links are clicked.
                $('form').on('click', 'a', function (e) {
                    e.preventDefault(); // Disable the default behavior of the anchor tag.
        
                    var target = $(this).attr('href').substring(1); // Getting the target id
                    var $targetElement = $('#' + target); // Getting the element by id
        
                    // Placing focus on the relevant input field.
                    if ($targetElement.length) {
                        $targetElement.focus();
                    } else if (target === 'gender') {
                        // If it's for gender, focus on the first radio button
                        $('input[name="gender"]').first().focus();
                    }
                });
            });
        
            // Validation function
            validateInput = function (input, message) {
                var $input = $('[name="' + input + '"]');
                var isValid = true;
                
                // Clear previous error messages for non-gender and non-checkbox inputs
                if (input !== 'gender' && input !== 'accept_agbs') {
                    $input.removeClass('invalid');
                    $input.next('.error').remove(); // Remove previous error message
                }
        
                // Check if the input is valid
                if (input === 'gender' && !$('[name="gender"]:checked').length) {
                    isValid = false;
                } else if (input === 'accept_agbs' && !$input.is(':checked')) {
                    isValid = false;
                } else if ($input.val().trim() === "") {
                    isValid = false;
                }
        
                // If the input is invalid, display an error message
                if (!isValid) {
                    var $errorContainer = $('fieldset.errors ul');
                    if ($errorContainer.length === 0) {
                        $('form').prepend('<fieldset class="errors"><legend>Errors</legend><ul></ul></fieldset>');
                        $errorContainer = $('fieldset.errors ul');
                    }
        
                    // Add error message in the summary if it's not already present
                    if (!$errorContainer.find('a[href="#' + input + '"]').length) {
                        $errorContainer.append('<li><a href="#' + input + '">' + message + '</a></li>');
                    }
        
                    // Gender Group Handling
                    if (input === 'gender') {
                        var $lastRadio = $('[name="gender"]').last();
                        if (!$lastRadio.next('.error').length) {
                            $lastRadio.after('<span class="error">Error: ' + message + '</span>'); //ERROR
                        }
                    }
                    // Seperate Checkbox Handling
                    else if (input === 'accept_agbs' && !$input.next('.error').length) {
                        $input.addClass('invalid');
                        $input.next('label').after('<span class="error">Error: ' + message + '</span>'); //ERROR
                    }
                    // Handle other inputs
                    else if (input !== 'gender' && !$input.next('.error').length) {
                        $input.addClass('invalid'); // Add error class to the input
                        $input.after('<span class="error">Error: ' + message + '</span>'); // ERROR MESSAGE
                    }
        
                    return false;
                } else {
                    // Remove the error from the error summary if the input is valid.
                    $('fieldset.errors ul li a[href="#' + input + '"]').closest('li').remove();
                    if ($('fieldset.errors ul li').length === 0) {
                        $('fieldset.errors').remove(); // Remove the entire error summary if there are no more errors
                    }
        
                    // Remove individual input errors
                    if (input !== 'gender' && input !== 'accept_agbs') {
                        $input.removeClass('invalid');
                        $input.next('.error').remove();
                    } else if (input === 'gender') {
                        $('[name="gender"]').last().next('.error').remove(); // Eliminate the gender error message.
                    } else if (input === 'accept_agbs') {
                        $input.next('label').next('.error').remove(); // Eliminate the checkbox error message.
                    }
                }
        
                return true;
            };
        </script>
                
        </body>
      </html>
